# Взаимодействие MS Word и MS Exel. Инструмент рассылки

Предположим, что у нас имеется вот такая таблица Excel:
![Информация о ключевых клиентах](Инструмент-Рассылки.assets/image.png)

В ней хранится информация о ключевых клиентах нашей компании (адреса, имена 
и т.д.), которых мы хотим поздравить с очередным праздником с помощью 
вот такого поздравительного письма в Word:

![Поздравительное письмо](Инструмент-Рассылки.assets/image-1.png)
Задача состоит в том, чтобы автоматически создать на каждого 
отдельное письмо, куда будут подставлены ФИО и название компании клиента, 
с тем чтобы потом эти письма вывести на печать. 
Решить подобную проблему можно либо в Excel с использованием макросов, 
либо с помощью специально созданного для этого инструмента 
в Microsoft Word - Слияния (Mail Merge).

## Шаг 1. Подготовка списка клиентов в Excel

Таблица со списком клиентов должна удовлетворять нескольким простым условиям:
* шапка таблицы должна быть простой - одна строка с уникальными названиями столбцов (без повторений и пустых ячеек)
* в таблице не должно быть объединенных ячеек
* в таблице не должно быть пустых строк или столбцов (отдельные пустые ячейки допускаются)
* т.к. Excel и Word не смогу сами определить пол клиента по имени, 
то имеет смысл сделать отдельный столбец с обращением (господин, 
госпожа и т.п.) или с родовым окончанием (-ый или -ая) для обращения 
"Уважаемый(ая)..."

### Шаг 2. Подготовка шаблона письма в Word

Здесь все проще - нужен обычный документ Word с оставленными в нем пустыми местами для вставки полей из списка Excel.
#### Шаг 3. Слияние

Открываем шаблон письма в Word и запускаем пошаговый Мастер Слияния 
на вкладке Рассылки (Mailings) кнопкой Начать слияние (Start Mail Merge) - 
Пошаговый мастер слияния (Step-by-Step Merge Wizard):

![Запуск Мастера слияния](Инструмент-Рассылки.assets/image-3.png)

##### Этап 1. Выбор типа документа.

![Выбор типа документа](Инструмент-Рассылки.assets/image-4.png)

На этом шаге пользователь должен выбрать тип тех документов, 
которые он хочет получить на выходе после слияния. Наш вариант
- Письма (Letters).

###### Этап 3. Выбор получателей

![Выбор получателей](Инструмент-Рассылки.assets/image-5.png)

На этом шаге мы подключаем список клиентов в Excel к документу Word. 
Выбираем Использование списка и жмем на Обзор (Browse), после чего 
в диалоговом окне открытия файла указываем где лежит наш файл со списком клиентов. 
После выбора источника данных, Word позволяет провести фильтрацию, 
сортировку и ручной отбор записей при помощи окна Получатели слияния:

![Подключение списка клиентов](Инструмент-Рассылки.assets/image-6.png) 

###### Этап 4. Создание письма

![Создание письма](Инструмент-Рассылки.assets/image-7.png)

На этом этапе пользователь должен указать - куда именно в документ 
должны попасть данные из подключенного списка. 
Для этого необходимо установить курсор в точку вставки в письме 
и использовать ссылку Другие элементы - она выводит полный набор 
всех полей списка, из которого мы и выбираем нужное поле для вставки:

![Поля слияния](Инструмент-Рассылки.assets/image-8.png)

###### Этап 5. Просмотр писем

На этом этапе пользователь уже может предварительно просмотреть результаты слияния, используя кнопки со стрелками. При необходимости, также, 
можно исключить любого получателя из набора.

###### Этап 6. Завершение слияния

![Завершение слияния](Инструмент-Рассылки.assets/image-9.png)

Нажатие ссылки Печать приведет к немедленной отправке всех результатов слияния 
на принтер без вывода на экран. 
Если необходимо сохранить созданные в результате слияния документы для дальнейшего использования или требуется внести ручную правку в некоторые из документов, то лучше использовать ссылку Изменить часть писем (Edit individual letters), которая выведет результаты слияния в отдельный файл.

## Источники

1. MS Word: создание серийных писем или рассылки [Электронный ресурс] URL: [https://nitforyou.com/ms-word-sozdanie-serijnyx-pisem] (дата обращения: 17.12.2023)
2. 	Почтовая рассылка средствами Word и Excel [Электронный ресурс] URL: [https://www.itshop.ru/Pochtovaya-rassylka-sredstvami-Word-i-Excel/l9i26132] (дата обращения: 17.12.2023)
3. Организация массовых рассылок в Microsoft Word [Электронный ресурс] URL: [http://obrazovanie-saratov.ru/index.php/component/content/article/13-glavnaya/971-organizatsiya-massovykh-rassylok-v-microsoft-word] (дата обращения: 17.12.2023)